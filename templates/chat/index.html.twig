
{#
{% extends 'base.html.twig' %}

{% block title %}Log in!{% endblock %}

{% block body %}

#}



{# ---------------------------------------- JavaScript ---------------------------------  #}
{# -------------------------------------------------------------------------------------  #}
{# ---------------------------------------- JavaScript ---------------------------------  #}

<!-- The core Firebase JS SDK is always required and must be listed first -->
<script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-app.js"></script>

<!-- TODO: Add SDKs for Firebase products that you want to use
     https://firebase.google.com/docs/web/setup#available-libraries -->
<script src="https://www.gstatic.com/firebasejs/8.2.4/firebase-database.js"></script>

<script>
    // Your web app's Firebase configuration
    // For Firebase JS SDK v7.20.0 and later, measurementId is optional
    var firebaseConfig = {
        apiKey: "AIzaSyCVDOntQpmpL_RkL5qaTS9ibiizUu4VS1E",
        authDomain: "chat-messaging-1e87d.firebaseapp.com",
        databaseURL: "https://chat-messaging-1e87d-default-rtdb.firebaseio.com",
        projectId: "chat-messaging-1e87d",
        storageBucket: "chat-messaging-1e87d.appspot.com",
        messagingSenderId: "452266648798",
        appId: "1:452266648798:web:69e7ea4cadce50a96dce4f",
        measurementId: "G-306C1Z0N9Z"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);






</script>

{# ---------------------------------------- JavaScript ---------------------------------  #}
{# -------------------------------------------------------------------------------------  #}
{# ---------------------------------------- JavaScript ---------------------------------  #}


<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8">
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css" integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh" crossorigin="anonymous">
        <script src="https://code.jquery.com/jquery-3.4.1.slim.min.js" integrity="sha384-J6qa4849blE2+poT4WnyKhv5vZF5SrPo0iEjwBvKU7imGFAV0wwj1yYfoRSJoZ+n" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.0/dist/umd/popper.min.js" integrity="sha384-Q6E9RHvbIyZFJoft+2mJbHaEWldlvI9IOYy5n3zV9zzTtmI3UksdQRVvoxMfooAo" crossorigin="anonymous"></script>
        <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.min.js" integrity="sha384-wfSDF2E50Y2D1uUdj0O3uMBJnjuUD4Ih7YwaYd1iqfktj0Uod8GCExl3Og8ifwB6" crossorigin="anonymous"></script>
    </head>

<body>

    <nav class=" navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
            {% if app.user %}
            <a class="navbar-brand" href="#">Welcome {{ app.user.username  }}</a>
            {% endif %}
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    {% if app.user %}
                    <a class="nav-link href="{{ path('app_logout') }}">Logout</a>
                    {% endif %}
                </div>

            </div>
        </div>
    </nav>


    <main class="content">
        <div class="container p-0">

            <h1 class="h3 mb-3">Messages</h1>

            <div class="card">
                <div class="row g-0">
                    <div class="col-12 col-lg-5 col-xl-3 border-right">

                        <div class="px-4 d-none d-md-block">
                            <div class="d-flex align-items-center">
                                <div class="flex-grow-1">
                                    <input type="text" class="form-control my-3" placeholder="Search...">
                                </div>
                            </div>
                        </div>

                        {% for user in users %}
                            {% if user.username != app.user.username %}
                             <a id="contact-profile"  onclick="loadSelectedChat(this)"  class="list-group-item list-group-item-action border-0" >
                                <div class="d-flex align-items-start">
                                    <img src="https://www.flaticon.com/svg/vstatic/svg/1077/1077114.svg?token=exp=1612168654~hmac=80ce6f80ba92ee41166afb99a26ca255" class="rounded-circle mr-1" alt="Sharon Lessman" width="40" height="40">
                                    <div  id="contactName" class="flex-grow-1 ml-3">

                                        {{ user.username }}

                                    </div>
                                </div>
                             </a>
                            {% endif %}
                        {% endfor %}


                        <hr class="d-block d-lg-none mt-1 mb-0">
                    </div>
                    <div class="col-12 col-lg-7 col-xl-9">
                        <div class="py-2 px-4 border-bottom d-none d-lg-block">
                            <div class="d-flex align-items-center py-1">
                                <div class="position-relative">
                                    <img src="https://www.flaticon.com/svg/vstatic/svg/1077/1077114.svg?token=exp=1612168654~hmac=80ce6f80ba92ee41166afb99a26ca255" class="rounded-circle mr-1" alt="Sharon Lessman" width="40" height="40">
                                </div>

                                {# ------ Other User ----   #}
                                <div  class="flex-grow-1 pl-3">

                                    <strong id="currentChatUserName"> </strong>
                                </div>
                                {# ------ Other User ----   #}

                            </div>
                        </div>


                        {# ------ Chat Messages ----   #}
                        <div class="position-relative">
                            <div class="chat-messages p-4">

                                <div class="chat-message-right pb-4">
                                    <div>
                                        <img src="https://www.flaticon.com/svg/vstatic/svg/1077/1077114.svg?token=exp=1612168654~hmac=80ce6f80ba92ee41166afb99a26ca255" class="rounded-circle mr-1" alt="Chris Wood" width="40" height="40">
                                        <div class="text-muted small text-nowrap mt-2">2:33 am</div>
                                    </div>
                                    <div class="flex-shrink-1 bg-light rounded py-2 px-3 mr-3">
                                        <div class="font-weight-bold mb-1">You</div>
                                        Lorem ipsum dolor sit amet, vis erat denique in, dicunt prodesset te vix.
                                    </div>
                                </div>

                                <div class="chat-message-left pb-4">
                                    <div>
                                        <img src="https://www.flaticon.com/svg/vstatic/svg/1077/1077114.svg?token=exp=1612168654~hmac=80ce6f80ba92ee41166afb99a26ca255" class="rounded-circle mr-1" alt="Sharon Lessman" width="40" height="40">
                                        <div class="text-muted small text-nowrap mt-2">2:34 am</div>
                                    </div>
                                    <div class="flex-shrink-1 bg-light rounded py-2 px-3 ml-3">
                                        <div class="font-weight-bold mb-1">Sharon Lessman</div>
                                        Sit meis deleniti eu, pri vidit meliore docendi ut, an eum erat animal commodo.
                                    </div>
                                </div>

                            </div>
                        </div>




                        {# ------ Send Messages ----   #}

                        <div class="flex-grow-0 py-3 px-4 border-top">
                            <form class="input-group" onsubmit="return sendMessage();">
                                <input id="message" class="form-control" placeholder="Type your message" >
                                <input type="submit" class="btn btn-primary" >
                            </form>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </main>



<script>


    let contactName = document.getElementById("contactName").innerHTML;
    let currentChatUserName = document.getElementById("currentChatUserName");


    function loadSelectedChat(e){

        currentChatUserName.innerHTML = e.innerText;

        return false;

    }

    
    function sendMessage(){

        //get message
        var message = document.getElementById("message").value;

        //save into database
        firebase.database().ref("message").push().set({
            "message": message

        });

        alert('this works');

        //prevent form from submitting
        return false;
    }


</script>


</body>

</html>











  {#  <ul>
        {% for user in users %}
            <li> {{ user.username }}</li>
        {% endfor %}
    </ul>

  #}

    {#

    <section>

{% for user in users %}
    <div class=" border border-primary container-fluid ml-lg-4" >
        <h6> {{ user.username }} </h6>
    </div>
{% endfor %}

</section>


    #}


    {#
 {% endblock %}
     #}